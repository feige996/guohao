<script lang="ts" setup>
import { ref } from 'vue'

definePage({
  style: {
    navigationBarTitleText: 'åŒ»ç”Ÿæˆ‘çš„',
  },
})

// æ¨¡æ‹ŸåŒ»ç”Ÿä¿¡æ¯æ•°æ®
const doctorInfo = ref({
  name: 'ææµ©',
  title: 'ä¸»ä»»åŒ»å¸ˆ',
  department: 'å†…åˆ†æ³Œç§‘',
  hospital: 'å›½æµ©ä¸­åŒ»é™¢',
  rating: '100%',
  consultationCount: 56800,
  avatar: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=400&h=400&fit=crop&crop=center',
  recordDate: '2025/02/11 14:32:21',
})

// æ¨¡æ‹Ÿæ”¶å…¥æ•°æ®
const incomeData = ref({
  month: '50.00',
  today: '50.00',
})

// æ¨¡æ‹Ÿè¯„ä»·æ•°æ®
const ratingData = ref({
  goodCount: 188,
  replyCount: 160,
})

// æœåŠ¡è®¾ç½®çŠ¶æ€
const serviceSettings = ref({
  textConsult: true,
  voiceConsult: false,
  videoConsult: false,
})

// å¤„ç†å¼€å…³åˆ‡æ¢
function handleSwitchChange(type: string, value: boolean) {
  switch (type) {
    case 'text':
      serviceSettings.value.textConsult = value
      break
    case 'voice':
      serviceSettings.value.voiceConsult = value
      break
    case 'video':
      serviceSettings.value.videoConsult = value
      break
  }
  console.log(`å¼€å…³${type}å·²åˆ‡æ¢ä¸º:`, value)
}

// ç‚¹å‡»æ¡£æ¡ˆåŒºåŸŸ
function handleRecordClick() {
  console.log('ç‚¹å‡»äº†æ¡£æ¡ˆåŒºåŸŸ')
  // è¿™é‡Œå¯ä»¥æ·»åŠ è·³è½¬åˆ°è¯¦ç»†æ¡£æ¡ˆé¡µé¢çš„é€»è¾‘
}

// ç‚¹å‡»æ”¶å…¥åŒºåŸŸ
function handleIncomeClick() {
  console.log('ç‚¹å‡»äº†æ”¶å…¥åŒºåŸŸ')
  // è¿™é‡Œå¯ä»¥æ·»åŠ è·³è½¬åˆ°æ”¶å…¥æ˜ç»†é¡µé¢çš„é€»è¾‘
}

// ç‚¹å‡»è¯„ä»·åŒºåŸŸ
function handleRatingClick() {
  console.log('ç‚¹å‡»äº†è¯„ä»·åŒºåŸŸ')
  // è¿™é‡Œå¯ä»¥æ·»åŠ è·³è½¬åˆ°è¯„ä»·è¯¦æƒ…é¡µé¢çš„é€»è¾‘
}

// æ ¼å¼åŒ–æ•°å­—ï¼Œæ·»åŠ åƒåˆ†ä½åˆ†éš”ç¬¦
function formatNumber(num: number): string {
  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')
}
</script>

<template>
  <view class="min-h-screen bg-gray-100">
    <!-- é¡¶éƒ¨åŒ»ç”Ÿä¿¡æ¯å¡ç‰‡ -->
    <view class="bg-white p-4">
      <view class="flex items-center">
        <!-- åŒ»ç”Ÿå¤´åƒ -->
        <image
          :src="doctorInfo.avatar"
          class="h-20 w-20 border-2 border-gray-200 rounded-full object-cover"
        />

        <!-- åŒ»ç”Ÿä¿¡æ¯ -->
        <view class="ml-4 flex-1">
          <view class="flex items-center">
            <text class="text-xl font-semibold">{{ doctorInfo.name }}</text>
            <text class="ml-2 text-base text-gray-600">{{ doctorInfo.title }}</text>
          </view>
          <view class="mt-1 flex items-center">
            <text class="mr-3 text-sm text-blue-500">{{ doctorInfo.department }}</text>
            <text class="text-sm text-gray-500">{{ doctorInfo.hospital }}</text>
          </view>
          <view class="mt-2 flex items-center">
            <text class="text-xs text-gray-500">å¥½è¯„:</text>
            <text class="ml-1 text-xs text-green-500">{{ doctorInfo.rating }}</text>
            <text class="ml-3 text-xs text-gray-500">æ¥è¯Š:</text>
            <text class="ml-1 text-xs text-blue-500">{{ formatNumber(doctorInfo.consultationCount) }}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„æ¡£æ¡ˆåŒºåŸŸ -->
    <view class="mt-3 bg-white p-4" @click="handleRecordClick">
      <view class="flex items-center">
        <view class="h-10 w-10 flex items-center justify-center rounded-full bg-blue-100">
          <text class="text-blue-500">ğŸ‘¤</text>
        </view>
        <view class="ml-4 flex-1">
          <view class="flex items-center justify-between">
            <text class="text-base font-medium">æˆ‘çš„æ¡£æ¡ˆ</text>
            <text class="text-xs text-gray-500">{{ doctorInfo.name }} {{ doctorInfo.title }}</text>
          </view>
          <view class="mt-1 flex items-center">
            <text class="mr-3 text-xs text-gray-500">{{ doctorInfo.department }}</text>
            <text class="text-xs text-gray-500">{{ doctorInfo.hospital }}</text>
          </view>
          <text class="mt-1 text-xs text-gray-400">{{ doctorInfo.recordDate }}</text>
        </view>
      </view>
    </view>

    <!-- ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ -->
    <view class="flex gap-4 mt-3 px-3">
      <!-- æˆ‘çš„æ”¶å…¥å¡ç‰‡ -->
      <view class="flex-1 rounded-lg bg-white p-4 shadow-sm" @click="handleIncomeClick">
        <view class="flex items-center">
          <view class="h-10 w-10 flex items-center justify-center rounded-full bg-orange-100">
            <text class="text-orange-500">ğŸ’°</text>
          </view>
          <text class="ml-3 text-base font-medium">æˆ‘çš„æ”¶å…¥</text>
        </view>
        <view class="mt-2">
          <view class="flex items-center justify-between">
            <text class="text-xs text-gray-500">æœ¬æœˆ:</text>
            <text class="text-sm text-orange-500">Â¥{{ incomeData.month }}</text>
          </view>
          <view class="mt-1 flex items-center justify-between">
            <text class="text-xs text-gray-500">ä»Šæ—¥:</text>
            <text class="text-sm text-orange-500">Â¥{{ incomeData.today }}</text>
          </view>
        </view>
      </view>

      <!-- æ‚£è€…è¯„ä»·å¡ç‰‡ -->
      <view class="flex-1 rounded-lg bg-white p-4 shadow-sm" @click="handleRatingClick">
        <view class="flex items-center">
          <view class="h-10 w-10 flex items-center justify-center rounded-full bg-yellow-100">
            <text class="text-yellow-500">ğŸ’¬</text>
          </view>
          <text class="ml-3 text-base font-medium">æ‚£è€…è¯„ä»·</text>
        </view>
        <view class="mt-2">
          <view class="flex items-center">
            <text class="text-yellow-400 text-xs">â­â­â­â­â­</text>
          </view>
          <view class="mt-1">
            <text class="text-xs text-gray-500">ç´¯è®¡å¥½è¯„: {{ ratingData.goodCount }}æ¡</text>
          </view>
          <view class="mt-1">
            <text class="text-xs text-gray-500">ç´¯è®¡å›å¤: {{ ratingData.replyCount }}æ¡</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æœåŠ¡è®¾ç½®åŒºåŸŸ -->
    <view class="mt-3 bg-white p-4">
      <view class="flex items-center justify-between">
        <view class="flex items-center">
          <view class="h-10 w-10 flex items-center justify-center rounded-full bg-red-100">
            <text class="text-red-500">âš™ï¸</text>
          </view>
          <text class="ml-3 text-base font-medium">æœåŠ¡è®¾ç½®</text>
        </view>
      </view>

      <!-- è®¾ç½®é¡¹ -->
      <view class="mt-4">
        <!-- å›¾æ–‡é—®è¯Š -->
        <view class="flex items-center justify-between border-b border-gray-100 py-3">
          <text class="text-base">å›¾æ–‡é—®è¯Š</text>
          <wd-switch
            v-model="serviceSettings.textConsult"
            active-color="#8c2303"
            inactive-color="#dcdfe6"
            @change="(val: any) => handleSwitchChange('text', val)"
          />
        </view>

        <!-- è¯­éŸ³é—®è¯Š -->
        <view class="flex items-center justify-between border-b border-gray-100 py-3">
          <text class="text-base">è¯­éŸ³é—®è¯Š</text>
          <wd-switch
            v-model="serviceSettings.voiceConsult"
            active-color="#8c2303"
            inactive-color="#dcdfe6"
            @change="(val: any) => handleSwitchChange('voice', val)"
          />
        </view>

        <!-- è§†é¢‘é—®è¯Š -->
        <view class="flex items-center justify-between py-3">
          <text class="text-base">è§†é¢‘é—®è¯Š</text>
          <wd-switch
            v-model="serviceSettings.videoConsult"
            active-color="#8c2303"
            inactive-color="#dcdfe6"
            @change="(val: any) => handleSwitchChange('video', val)"
          />
        </view>
      </view>
    </view>
  </view>
</template>
