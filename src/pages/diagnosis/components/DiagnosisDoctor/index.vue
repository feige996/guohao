<script lang="ts" setup>
definePage({
  style: {
    navigationBarTitleText: 'åŒ»ç”Ÿé—®è¯Š',
  },
})

// é—®è¯Šæ•°æ®
const consultationData = {
  todayConsult: 36,
  remainingConsult: 18,
  todayPrescription: 6,
}

// å¾…è¯Šæ‚£è€…æ•°æ®
const waitingPatients = [
  {
    id: 1,
    name: 'ç‹å†›',
    gender: 'ç”·',
    avatar: 'https://images.unsplash.com/photo-1603415526960-f7e0328c63b1?w=100&h=100&fit=crop&crop=center',
    type: 'å¤è¯Š',
    disease: '2å‹ç³–å°¿ç—…',
    lastConsultDate: '6æœˆ10æ—¥',
    consultationTime: '2025/02/11 14:32:21',
  },
  {
    id: 2,
    name: 'åˆ˜è‰³',
    gender: 'å¥³',
    avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop&crop=center',
    type: 'å¤è¯Š',
    disease: '2å‹ç³–å°¿ç—…',
    lastConsultDate: '6æœˆ10æ—¥',
    consultationTime: '2025/02/11 14:32:21',
  },
  {
    id: 3,
    name: 'é™ˆæ³°æ¥',
    gender: 'ç”·',
    avatar: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=100&h=100&fit=crop&crop=center',
    type: 'å¤è¯Š',
    disease: '2å‹ç³–å°¿ç—…',
    lastConsultDate: '6æœˆ10æ—¥',
    consultationTime: '2025/02/11 14:32:21',
  },
]

// å¤„ç†å›¾æ–‡é—®è¯Š
function handleTextConsult(patientId: number) {
  console.log('å›¾æ–‡é—®è¯Š:', patientId)
}

// å¤„ç†æŸ¥çœ‹æ¡£æ¡ˆ
function handleViewRecord(patientId: number) {
  console.log('æŸ¥çœ‹æ¡£æ¡ˆ:', patientId)
}

// å¤„ç†å‘é€æé†’
function handleSendReminder(patientId: number) {
  console.log('å‘é€æé†’:', patientId)
}

// å¯¼èˆªåˆ°æˆ‘çš„è¯Šå®¤
function navigateToConsultationRoom() {
  console.log('å¯¼èˆªåˆ°æˆ‘çš„è¯Šå®¤')
  uni.navigateTo({
    url: '/pages/doctor/diagnosis/consultationRoom'
  })
}

// å¯¼èˆªåˆ°å¼€æ–¹é¡µé¢
function navigateToPrescription(): void {
  console.log('å¯¼èˆªåˆ°å¼€æ–¹é¡µé¢')
  uni.navigateTo({
    url: '/pages/doctor/diagnosis/newPrescription'
  })
}
</script>

<template>
  <view class="min-h-screen bg-gray-50 pb-20">
    <!-- é—®è¯Šæ•°æ®åŒºåŸŸ -->
    <view class="mb-3 p-4 border border-blue-200 rounded-xl bg-gradient-to-r from-blue-50 to-cyan-50">
      <view class="mb-4 text-base font-medium">
        é—®è¯Šæ•°æ®
      </view>
      <view class="grid grid-cols-3 gap-3">
        <!-- ä»Šæ—¥æ¥è¯Š -->
        <view class="flex flex-col items-center">
          <view class="mb-2 h-12 w-12 flex items-center justify-center rounded-full bg-red-50">
            <text class="text-lg text-red-500">ğŸ‘¤</text>
          </view>
          <text class="text-sm text-gray-500">ä»Šæ—¥æ¥è¯Š</text>
          <text class="text-lg text-gray-800 font-medium">{{ consultationData.todayConsult }}</text>
        </view>

        <!-- å‰©ä½™é—®è¯Š -->
        <view class="flex flex-col items-center">
          <view class="mb-2 h-12 w-12 flex items-center justify-center rounded-full bg-yellow-50">
            <text class="text-lg text-yellow-500">ğŸ“</text>
          </view>
          <text class="text-sm text-gray-500">å‰©ä½™é—®è¯Š</text>
          <text class="text-lg text-gray-800 font-medium">{{ consultationData.remainingConsult }}</text>
        </view>

        <!-- ä»Šæ—¥å¼€æ–¹ -->
        <view class="flex flex-col items-center">
          <view class="mb-2 h-12 w-12 flex items-center justify-center rounded-full bg-green-50">
            <text class="text-lg text-green-500">ğŸ“‹</text>
          </view>
          <text class="text-sm text-gray-500">ä»Šæ—¥å¼€æ–¹</text>
          <text class="text-lg text-gray-800 font-medium">{{ consultationData.todayPrescription }}</text>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½æŒ‰é’®åŒºåŸŸ -->
    <view class="mb-4 flex gap-3 px-4">
      <view class="flex flex-1 items-center justify-between rounded-lg bg-blue-50 p-3" @click="navigateToConsultationRoom">
        <view class="flex items-center">
          <view class="mr-2 h-8 w-8 flex items-center justify-center rounded-full bg-blue-100">
            <text class="text-blue-500">ğŸ‘¨â€âš•ï¸</text>
          </view>
          <text class="text-gray-800 font-medium">æˆ‘çš„è¯Šå®¤</text>
        </view>
        <text class="text-blue-500">â€º</text>
      </view>

      <view class="flex flex-1 items-center justify-between rounded-lg bg-orange-50 p-3" @click="navigateToPrescription">
        <view class="flex items-center">
          <view class="mr-2 h-8 w-8 flex items-center justify-center rounded-full bg-orange-100">
            <text class="text-orange-500">ğŸ“</text>
          </view>
          <text class="text-gray-800 font-medium">æˆ‘è¦å¼€æ–¹</text>
        </view>
        <text class="text-orange-500">â€º</text>
      </view>
    </view>

    <!-- å¾…è¯Šæ‚£è€…åŒºåŸŸ -->
    <view class="bg-white p-4">
      <view class="mb-4 text-base font-medium">
        å¾…è¯Šæ‚£è€…
      </view>

      <!-- æ‚£è€…åˆ—è¡¨ -->
      <view class="space-y-4">
        <view
          v-for="patient in waitingPatients"
          :key="patient.id"
          class="border-b border-gray-100 pb-4 last:border-0 last:pb-0"
        >
          <view class="mb-2 flex items-center">
            <image
              :src="patient.avatar"
              class="mr-3 h-10 w-10 rounded-full object-cover"
            />
            <view>
              <view class="flex items-center">
                <text class="mr-2 text-base font-medium">{{ patient.name }}</text>
                <text :class="patient.gender === 'ç”·' ? 'text-blue-500' : 'text-pink-500'">
                  {{ patient.gender === 'ç”·' ? 'ç”·' : 'å¥³' }}
                </text>
              </view>
              <view class="mt-1 flex items-center text-xs text-gray-500">
                <text class="mr-2">{{ patient.type }}</text>
                <text class="mr-2">{{ patient.disease }}</text>
                <text>ä¸Šæ¬¡é—®è¯Š: {{ patient.lastConsultDate }}</text>
              </view>
            </view>
          </view>

          <text class="mb-3 text-xs text-gray-400">{{ patient.consultationTime }}</text>

          <view class="flex gap-2">
            <button
              class="flex-1 rounded bg-red-500 py-2 text-sm text-white"
              @click="handleTextConsult(patient.id)"
            >
              å›¾æ–‡é—®è¯Š
            </button>
            <button
              class="flex-1 rounded bg-yellow-500 py-2 text-sm text-white"
              @click="handleViewRecord(patient.id)"
            >
              æ£€ç´¢æ¡£æ¡ˆ
            </button>
            <button
              class="flex-1 rounded bg-green-500 py-2 text-sm text-white"
              @click="handleSendReminder(patient.id)"
            >
              å‘é€æé†’
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <view class="fixed bottom-0 left-0 right-0 flex items-center justify-around border-t border-gray-200 bg-white py-2">
      <view class="flex flex-col items-center py-1 text-xs text-gray-500">
        <text class="mb-1 text-lg">ğŸ </text>
        <text>é¦–é¡µ</text>
      </view>
      <view class="flex flex-col items-center py-1 text-xs text-gray-500">
        <text class="mb-1 text-lg">ğŸ‘¥</text>
        <text>æ‚£è€…</text>
      </view>
      <view class="flex flex-col items-center py-1 text-xs text-red-500">
        <text class="mb-1 text-lg">ğŸ’Š</text>
        <text>é—®è¯Š</text>
      </view>
      <view class="flex flex-col items-center py-1 text-xs text-gray-500">
        <text class="mb-1 text-lg">ğŸ“Š</text>
        <text>ç—…å†</text>
      </view>
    </view>
  </view>
</template>
